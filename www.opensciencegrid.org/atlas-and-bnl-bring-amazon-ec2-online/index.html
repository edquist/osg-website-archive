<!doctype html>
<html>
<head>
	<meta name="viewport" content="width=device-width, initial-scale=1.0">
	<link href="https://www.opensciencegrid.org/wp-content/themes/osg/bootstrap/css/bootstrap.osg.min.css" rel="stylesheet">
	<link href="https://www.opensciencegrid.org/wp-content/themes/osg/bootstrap/css/bootstrap-responsive.css" rel="stylesheet">

	<meta name="description" content="">
	<meta name="author" content="">

        <meta charset="UTF-8" />
        <title>Open Science Grid</title>
        <link rel="stylesheet" href="https://www.opensciencegrid.org/wp-content/themes/osg/style.css" type="text/css" media="screen" />
        <link rel="pingback" href="https://www.opensciencegrid.org/xmlrpc.php" />
        	        <link rel='dns-prefetch' href='//s.w.org' />
<link rel="alternate" type="application/rss+xml" title="Open Science Grid &raquo; ATLAS and BNL Bring Amazon EC2 Online Comments Feed" href="https://www.opensciencegrid.org/atlas-and-bnl-bring-amazon-ec2-online/feed/" />
		<script type="text/javascript">
			window._wpemojiSettings = {"baseUrl":"https:\/\/s.w.org\/images\/core\/emoji\/2.4\/72x72\/","ext":".png","svgUrl":"https:\/\/s.w.org\/images\/core\/emoji\/2.4\/svg\/","svgExt":".svg","source":{"concatemoji":"https:\/\/www.opensciencegrid.org\/wp-includes\/js\/wp-emoji-release.min.js?ver=4.9.3"}};
			!function(a,b,c){function d(a,b){var c=String.fromCharCode;l.clearRect(0,0,k.width,k.height),l.fillText(c.apply(this,a),0,0);var d=k.toDataURL();l.clearRect(0,0,k.width,k.height),l.fillText(c.apply(this,b),0,0);var e=k.toDataURL();return d===e}function e(a){var b;if(!l||!l.fillText)return!1;switch(l.textBaseline="top",l.font="600 32px Arial",a){case"flag":return!(b=d([55356,56826,55356,56819],[55356,56826,8203,55356,56819]))&&(b=d([55356,57332,56128,56423,56128,56418,56128,56421,56128,56430,56128,56423,56128,56447],[55356,57332,8203,56128,56423,8203,56128,56418,8203,56128,56421,8203,56128,56430,8203,56128,56423,8203,56128,56447]),!b);case"emoji":return b=d([55357,56692,8205,9792,65039],[55357,56692,8203,9792,65039]),!b}return!1}function f(a){var c=b.createElement("script");c.src=a,c.defer=c.type="text/javascript",b.getElementsByTagName("head")[0].appendChild(c)}var g,h,i,j,k=b.createElement("canvas"),l=k.getContext&&k.getContext("2d");for(j=Array("flag","emoji"),c.supports={everything:!0,everythingExceptFlag:!0},i=0;i<j.length;i++)c.supports[j[i]]=e(j[i]),c.supports.everything=c.supports.everything&&c.supports[j[i]],"flag"!==j[i]&&(c.supports.everythingExceptFlag=c.supports.everythingExceptFlag&&c.supports[j[i]]);c.supports.everythingExceptFlag=c.supports.everythingExceptFlag&&!c.supports.flag,c.DOMReady=!1,c.readyCallback=function(){c.DOMReady=!0},c.supports.everything||(h=function(){c.readyCallback()},b.addEventListener?(b.addEventListener("DOMContentLoaded",h,!1),a.addEventListener("load",h,!1)):(a.attachEvent("onload",h),b.attachEvent("onreadystatechange",function(){"complete"===b.readyState&&c.readyCallback()})),g=c.source||{},g.concatemoji?f(g.concatemoji):g.wpemoji&&g.twemoji&&(f(g.twemoji),f(g.wpemoji)))}(window,document,window._wpemojiSettings);
		</script>
		<style type="text/css">
img.wp-smiley,
img.emoji {
	display: inline !important;
	border: none !important;
	box-shadow: none !important;
	height: 1em !important;
	width: 1em !important;
	margin: 0 .07em !important;
	vertical-align: -0.1em !important;
	background: none !important;
	padding: 0 !important;
}
</style>
<link rel='stylesheet' id='validate-engine-css-css'  href='https://www.opensciencegrid.org/wp-content/plugins/wysija-newsletters/css/validationEngine.jquery.css?ver=2.7.10' type='text/css' media='all' />
<script type='text/javascript' src='https://www.opensciencegrid.org/wp-includes/js/jquery/jquery.js?ver=1.12.4'></script>
<script type='text/javascript' src='https://www.opensciencegrid.org/wp-includes/js/jquery/jquery-migrate.min.js?ver=1.4.1'></script>
<link rel='https://api.w.org/' href='https://www.opensciencegrid.org/wp-json/' />
<link rel="EditURI" type="application/rsd+xml" title="RSD" href="https://www.opensciencegrid.org/xmlrpc.php?rsd" />
<link rel="wlwmanifest" type="application/wlwmanifest+xml" href="https://www.opensciencegrid.org/wp-includes/wlwmanifest.xml" /> 
<link rel='prev' title='Opportunistic Resources Report for December 2015 &#8211; January 2016' href='https://www.opensciencegrid.org/opportunistic-resources-report-for-december-2015-january-2016/' />
<link rel='next' title='OSG Year-end Operations Update' href='https://www.opensciencegrid.org/osg-operations-update/' />
<meta name="generator" content="WordPress 4.9.3" />
<link rel="canonical" href="https://www.opensciencegrid.org/atlas-and-bnl-bring-amazon-ec2-online/" />
<script type='text/javascript'>
							SG_POPUPS_QUEUE = [];
							SG_POPUP_DATA = [];
							SG_APP_POPUP_URL = 'https://www.opensciencegrid.org/wp-content/plugins/popup-builder';
							SG_POPUP_VERSION='2.61_1;';
							function sgAddEvent(element, eventName, fn) {
								if (element.addEventListener)
									element.addEventListener(eventName, fn, false);
								else if (element.attachEvent)
									element.attachEvent('on' + eventName, fn);
							}
						</script><link rel="icon" href="https://www.opensciencegrid.org/wp-content/uploads/2018/01/favicon-32x32.png" sizes="32x32" />
<link rel="icon" href="https://www.opensciencegrid.org/wp-content/uploads/2018/01/favicon-32x32.png" sizes="192x192" />
<link rel="apple-touch-icon-precomposed" href="https://www.opensciencegrid.org/wp-content/uploads/2018/01/favicon-32x32.png" />
<meta name="msapplication-TileImage" content="https://www.opensciencegrid.org/wp-content/uploads/2018/01/favicon-32x32.png" />
	<!--
	<script src="https://www.opensciencegrid.org/wp-content/themes/osg/jquery-1.9.1.min.js"></script>
	-->
</head>

<body>


<style type="text/css">
</style>

<div class="container-narrow">

<div class="masthead">
	<ul class="nav nav-pills pull-right">
	<li ><a href="../index.html">Home</a></li>
	<li ><a href="/about">About</a></li>
	<li class="active"><a href="/news">News</a></li>
	<li ><a href="/contact">Contact</a></li>
	</ul>
	<h3 class="muted"><img src="https://www.opensciencegrid.org/wp-content/themes/osg/images/new_osglogo.78x40.png"><!--<img src="https://www.opensciencegrid.org/wp-content/themes/osg/images/osg.diamonds.64.png">--><img src="https://www.opensciencegrid.org/wp-content/themes/osg/images/open_science_grid.png"></h3>
<h3 style="font-size:18pt"></h3>
</div>

<hr>

<h3>ATLAS and BNL Bring Amazon EC2 Online</h3>
<p><span style="font-weight: 400;">Four years ago the ATLAS and CMS experiments at the LHC successfully found the Higgs particle. In the US, most processing was performed on resources owned by the LHC collaborations, knit together and managed as part of the Open Science Grid. Since then the LHC experiments continue to explore the properties of the Higgs, and expand their studies beyond it. Alas, the budgets for maintaining dedicated data centers are flat or falling, but the scientific need for compute power remains.</span></p>
<p><a href="http://www.opensciencegrid.org/wp-content/uploads/2016/02/run203602_evt82614360_ID_LAR_Atlantis_hres.png"><img class="alignleft wp-image-222881 size-medium" src="http://www.opensciencegrid.org/wp-content/uploads/2016/02/run203602_evt82614360_ID_LAR_Atlantis_hres-300x300.png" alt="run203602_evt82614360_ID_LAR_Atlantis_hres" width="300" height="300" srcset="https://www.opensciencegrid.org/wp-content/uploads/2016/02/run203602_evt82614360_ID_LAR_Atlantis_hres-300x300.png 300w, https://www.opensciencegrid.org/wp-content/uploads/2016/02/run203602_evt82614360_ID_LAR_Atlantis_hres-150x150.png 150w, https://www.opensciencegrid.org/wp-content/uploads/2016/02/run203602_evt82614360_ID_LAR_Atlantis_hres-600x600.png 600w, https://www.opensciencegrid.org/wp-content/uploads/2016/02/run203602_evt82614360_ID_LAR_Atlantis_hres.png 640w" sizes="(max-width: 300px) 100vw, 300px" /></a></p>
<p>Three technical barriers have stood in the way of ATLAS economically using commercial clouds.</p>
<p><span style="font-weight: 400;"> First, the need to use Amazon’s Elastic Compute Cloud (EC2) spot market. Computing on the spot market is 1/10 to ¼ the cost of on-demand instances, resulting in core/hour costs comparable (or even cheaper) than dedicated ATLAS-owned data centers.  But nodes acquired on the spot market can be terminated at any time, meaning workload needs to be interruptable. The second barrier is the need to automatically and safely manage the acquisition and shutdown of large numbers of virtual machines (VMs). Handling this scale manually is not possible. The third barrier is the need to avoid slow data movement and costly data egress fees.</span></p>
<p><span style="font-weight: 400;">Over the last 18 months, the RHIC/ATLAS Computing Facility (RACF) at Brookhaven National Laboratory has been collaborating with Amazon on a pilot project to solve these problems, and move the usage of the Amazon Web Services (AWS) and the EC2 Spot market from theoretical possibility to a practical, production-grade, 100,000-core platform for doing science.</span></p>
<p><span style="font-weight: 400;">ATLAS had already been developing an enhancement to PanDA (Production and Distributed Analysis), their workload management system, that offers an </span><i><span style="font-weight: 400;">event-based</span></i><span style="font-weight: 400;"> processing model rather than a job-based approach. This </span><i><span style="font-weight: 400;">Event Service</span></i><span style="font-weight: 400;"> allows a worker process to complete one event at a time, uploading output when it is complete. Since events take much less time to analyze than jobs (which might process hundreds of events), if a worker is killed very little work is lost. The feature is ideal for use on EC2 spot, where nodes can be terminated whenever the spot price exceeds the user’s bid price.</span></p>
<p><span style="font-weight: 400;">To address the VM management problem, ATLAS adapted their existing HTCondor-G based pilot submission tool, AutoPyFactory, to also handle the VM lifecycle. When it detects waiting jobs in the ATLAS queues, it launches an appropriate number of VMs, maintains the number as nodes are terminated, and shuts them down as work is completed.</span></p>
<p><span style="font-weight: 400;">Addressing the data movement problem required two changes. First, the ATLAS workload system had to be adjusted to enable the usage of object-based storage so that it could natively leverage the Amazon Simple Storage Service (S3). Some related work was already being done for the Event Service in this direction. Other work toward making object stores first-class ATLAS storage endpoints is still underway.</span></p>
<p><span style="font-weight: 400;">Second, to avoid causing data flows between BNL and Amazon to travel over the public internet (which is costly for Amazon), ESNet has put in place high bandwidth (20-100GB), direct network peering between the DOE research network and AWS. Because usage of these peering points is not costing Amazon extra, they are willing to waive the customary egress charges as long as substantial compute resources are being purchased.  </span></p>
<p>&nbsp;</p>
<div id="attachment_222951" style="max-width: 610px" class="wp-caption aligncenter"><a href="http://www.opensciencegrid.org/wp-content/uploads/2016/02/EC2-Data-Movement-OSG1.png"><img class="wp-image-222951 size-full" src="http://www.opensciencegrid.org/wp-content/uploads/2016/02/EC2-Data-Movement-OSG1.png" alt="EC2 Data Movement OSG" width="600" height="450" srcset="https://www.opensciencegrid.org/wp-content/uploads/2016/02/EC2-Data-Movement-OSG1.png 600w, https://www.opensciencegrid.org/wp-content/uploads/2016/02/EC2-Data-Movement-OSG1-300x225.png 300w" sizes="(max-width: 600px) 100vw, 600px" /></a><p class="wp-caption-text">ATLAS EC2 Data Movement</p></div>
<p>&nbsp;</p>
<p><span style="font-weight: 400;">Last September, RACF and ATLAS performed a ~40,000-core, 7-day scaling run (~5000 8-core VMs). This run performed useful ATLAS analysis, using real data, on the EC2 Eastern region, on two instance types.</span></p>
<p><span style="font-weight: 400;">A final 100,000-core run is planned for mid-February. This run will utilize all three EC2 US regions, using (at least) 5 instance types, with all job data movement using native S3. A successful run will demonstrate the ability to economically provide, when needed, computing resources twice the size of the existing US ATLAS data centers (~50,000 cores).</span></p>
<p>-John Hover</p>

<hr>

</div><!--container-narrow-->
<footer>
<div class="footer-content">
<div class="row-fluid">
<div class="span8">
Funded by <a href="http://nsf.gov" target="_blank">National Science Foundation</a> and <a href="http://science.energy.gov/" target="_blank">Department of Energy</a><br>
</div>
<div class="span4">
<p class="pull-right">&copy; 2013-2018 Open Science Grid | <a target="_blank" href="https://twiki.grid.iu.edu/bin/view/Operations/IUPrivacyPolicy">Privacy Policy</a> <!--<a href="https://plus.google.com/117155860240957321314" rel="publisher">Google+</a>--></p>
<p></p>
</div>
</div><!--row-fluid-->
</div><!--cooter content-->
</footer>

<script src="https://www.opensciencegrid.org/wp-content/themes/osg/bootstrap/js/bootstrap.min.js"></script>

<script>
jQuery(function() {
		/*bootstrap-ify things*/
	jQuery("table.icalprop").addClass("pull-right");
	jQuery("table.ical").addClass("table");
	jQuery("table.ical .addevent").addClass("pull-right");
	jQuery("table.ical .map").addClass("pull-left");
	jQuery(".wysija-submit").addClass("btn btn-primary");
});
</script>

<script type='text/javascript' src='https://www.opensciencegrid.org/wp-includes/js/comment-reply.min.js?ver=4.9.3'></script>
<script type='text/javascript' src='https://www.opensciencegrid.org/wp-includes/js/wp-embed.min.js?ver=4.9.3'></script>
 
<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-69012-28', 'opensciencegrid.org');
  ga('send', 'pageview');

</script>
</body>
</html>

